<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>kWhSplit - Répartition Facture Électricité</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Background Gradient -->
    <div class="gradient-bg"></div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <div class="container-mobile">
        <header class="text-center mb-4 header-animated">
            <div class="logo-container-premium">
                <div class="logo-glow"></div>
                <div class="logo-ring"></div>
                <i class="fas fa-bolt logo-icon"></i>
            </div>
            <h1 class="mobile-title gradient-text-premium">kWhSplit</h1>
            <p class="subtitle-premium">Gestion intelligente des factures électriques</p>
            <div class="header-divider"></div>
        </header>

        <!-- Guide d'utilisation -->
        <div class="guide-card glass-card mb-3">
            <div class="guide-header" onclick="toggleGuide()">
                <div class="guide-title">
                    <i class="fas fa-info-circle me-2"></i>
                    <span>Comment ça marche ?</span>
                </div>
                <i class="fas fa-chevron-down guide-toggle" id="guideToggle"></i>
            </div>
            <div class="guide-content" id="guideContent">
                <div class="guide-step">
                    <div class="step-number">1</div>
                    <div class="step-text">Sélectionnez le <strong>mois</strong> de la facture</div>
                </div>
                <div class="guide-step">
                    <div class="step-number">2</div>
                    <div class="step-text">Entrez le <strong>montant total</strong> de la facture</div>
                </div>
                <div class="guide-step">
                    <div class="step-number">3</div>
                    <div class="step-text">Chaque personne entre ses <strong>anciens et nouveaux index</strong></div>
                </div>
                <div class="guide-step">
                    <div class="step-number">4</div>
                    <div class="step-text">Le calcul se fait <strong>automatiquement</strong> !</div>
                </div>
                <div class="guide-step">
                    <div class="step-number">5</div>
                    <div class="step-text">Cliquez sur <strong>Sauvegarder</strong> pour conserver l'historique</div>
                </div>
            </div>
        </div>

        <!-- Formulaire principal -->
        <div class="glass-card main-card mb-3">
            <div class="card-body p-3">
                <div class="mb-3">
                    <label for="mois" class="form-label fw-semibold">
                        <i class="fas fa-calendar-alt me-2"></i>Mois de la facture
                    </label>
                    <input type="month" class="form-control modern-input" id="moisInput" onchange="updateMoisLabel()">
                    <input type="hidden" id="mois">
                    <div class="mois-display" id="moisDisplay"></div>
                    <div class="helper-text">
                        <i class="fas fa-lightbulb"></i>
                        <span>Sélectionnez le mois de votre facture d'électricité</span>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="factureTotale" class="form-label fw-semibold">
                        <i class="fas fa-file-invoice-dollar me-2"></i>Montant total de la facture
                    </label>
                    <input type="number" class="form-control modern-input" id="factureTotale" placeholder="191617" step="0.01" oninput="calculerFacture()" inputmode="numeric">
                    <div class="helper-text">
                        <i class="fas fa-lightbulb"></i>
                        <span>Montant total en Ariary indiqué sur la facture</span>
                    </div>
                </div>

                <div class="action-buttons mb-3">
                    <button class="btn btn-gradient-primary btn-mobile" onclick="sauvegarderMois()">
                        <i class="fas fa-save"></i><span>Sauvegarder</span>
                    </button>
                    <button class="btn btn-gradient-info btn-mobile" onclick="afficherHistorique()">
                        <i class="fas fa-history"></i><span>Historique</span>
                    </button>
                    <button class="btn btn-gradient-success btn-mobile" onclick="nouveauMois()">
                        <i class="fas fa-calendar-plus"></i><span>Nouveau mois</span>
                    </button>
                </div>

                <!-- Liste des personnes (Mobile) -->
                <div class="section-title mt-4 mb-3">
                    Colocataires
                </div>
                <div id="listePersonnes">
                    <!-- Les cartes seront ajoutées dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Résumé (Mobile optimisé) -->
        <div class="glass-card resume-card mb-3" id="resumeCard" style="display: none;">
            <div class="card-body p-3">
                <h6 class="card-title fw-bold mb-3">
                    <i class="fas fa-chart-pie me-2"></i>Résumé
                </h6>
                <div class="stats-grid">
                    <div class="stat-card-mobile stat-purple">
                        <div class="stat-icon-mobile">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-content-mobile">
                            <span class="stat-label-mobile">kWh Total</span>
                            <strong class="stat-value-mobile" id="totalKwh">0</strong>
                        </div>
                    </div>
                    <div class="stat-card-mobile stat-blue">
                        <div class="stat-icon-mobile">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="stat-content-mobile">
                            <span class="stat-label-mobile">Prix/kWh</span>
                            <strong class="stat-value-mobile"><span id="prixKwh">0</span> Ar</strong>
                        </div>
                    </div>
                    <div class="stat-card-mobile stat-green">
                        <div class="stat-icon-mobile">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="stat-content-mobile">
                            <span class="stat-label-mobile">Total</span>
                            <strong class="stat-value-mobile"><span id="totalMontants">0</span> Ar</strong>
                        </div>
                    </div>
                    <div class="stat-card-mobile stat-orange">
                        <div class="stat-icon-mobile">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <div class="stat-content-mobile">
                            <span class="stat-label-mobile">Écart</span>
                            <strong class="stat-value-mobile"><span id="ecart">0</span> Ar</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section Historique (Collapsible) -->
        <div class="glass-card historique-section mb-3" id="historiqueSection" style="display: none;">
            <div class="historique-header" onclick="toggleHistoriqueSection()">
                <div class="historique-title-bar">
                    <div>
                        <i class="fas fa-history me-2"></i>
                        <span class="historique-section-title">Historique</span>
                        <span class="historique-count" id="historiqueCount">0 mois</span>
                    </div>
                    <i class="fas fa-chevron-down historique-toggle-icon" id="historiqueToggleIcon"></i>
                </div>
            </div>
            <div class="historique-body" id="historiqueBody">
                <div id="historiqueContent">
                    <!-- Contenu de l'historique -->
                </div>
            </div>
        </div>
    </div>

    <!-- Floating particles animation -->
    <div class="particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- Copyright Footer -->
    <footer class="copyright-footer">
        <div class="copyright-content">
            <div class="copyright-text">
                <i class="fas fa-bolt copyright-icon"></i>
                <span>© 2025 <strong>Mitia</strong> - kWhSplit</span>
            </div>
            <div class="copyright-tagline">
                Gestion intelligente des factures électriques
            </div>
            <div class="copyright-version">
                v1.0.0
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JS -->
    <script src="script.js"></script>
</body>
</html>
